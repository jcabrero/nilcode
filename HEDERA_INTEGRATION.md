# Hedera AI Agent Kit Integration with NilCode

This document provides a comprehensive guide for integrating the Hedera AI Agent Kit with the NilCode multi-agent system.

## Overview

The Hedera integration adds blockchain capabilities to NilCode, allowing the multi-agent system to create:
- **Hedera AI Agents**: Conversational agents that interact with the Hedera network
- **Hedera DApps**: Complete decentralized applications with frontend and backend
- **Hedera Smart Contracts**: Solidity contracts with deployment and testing infrastructure
- **Hedera Tools**: Reusable tools for Hedera operations

## Architecture

### New Agent: Hedera Agent
- **File**: `src/nilcode/agents/hedera_agent.py`
- **Purpose**: Handles all blockchain and Hedera network operations
- **Capabilities**:
  - TypeScript/Node.js project setup
  - Hedera SDK integration
  - AI agent creation with LangChain
  - Smart contract development
  - DApp frontend and backend creation

### New Tools: Hedera Tools
- **File**: `src/nilcode/tools/hedera_tools.py`
- **Tools Available**:
  - `create_hedera_package_json`: Sets up package.json with Hedera dependencies
  - `create_tsconfig_json`: Creates TypeScript configuration
  - `create_hedera_env_example`: Sets up environment variables template
  - `create_hedera_client_template`: Creates Hedera client configuration
  - `create_hedera_agent_template`: Creates AI agent implementation
  - `create_hedera_main_template`: Creates main application entry point
  - `create_hedera_readme`: Creates comprehensive documentation
  - `validate_hedera_project_structure`: Validates project completeness

### Enhanced State Management
- **File**: `src/nilcode/state/agent_state.py`
- **New Fields**:
  - `blockchain_tech`: List of blockchain technologies (e.g., ["hedera"])
  - `hedera_network`: Network type ("testnet", "mainnet", "previewnet")
  - `hedera_account_id`: Hedera account ID for operations
  - `hedera_private_key`: Hedera private key (stored securely)
  - `ai_provider`: AI provider type ("openai", "anthropic", "groq", "ollama")
  - `ai_provider_key`: API key for the chosen AI provider

### Updated Workflow
- **File**: `src/nilcode/main_agent.py`
- **Changes**:
  - Added Hedera agent to workflow graph
  - Updated routing to include blockchain operations
  - Integrated Hedera tools into the system

## Usage Examples

### 1. Basic Hedera AI Agent

```python
from nilcode.main_agent import create_workflow
from nilcode.state.agent_state import create_initial_state

# Create workflow
workflow = create_workflow(api_key)

# Request for Hedera AI agent
user_request = """
Create a Hedera AI agent that can:
- Check account balances
- Transfer tokens
- Answer questions about Hedera
- Support multiple AI providers
"""

# Create initial state with blockchain context
initial_state = create_initial_state(user_request)
initial_state.update({
    "blockchain_tech": ["hedera"],
    "hedera_network": "testnet",
    "ai_provider": "openai"
})

# Execute workflow
final_state = workflow.invoke(initial_state)
```

### 2. Complete Hedera DApp

```python
# Request for full DApp
user_request = """
Create a complete Hedera DApp with:
- React frontend with wallet connection
- Node.js backend with Hedera API
- Token transfer functionality
- Real-time balance updates
- AI-powered transaction assistance
"""

initial_state = create_initial_state(user_request)
initial_state.update({
    "blockchain_tech": ["hedera"],
    "frontend_tech": ["react", "typescript"],
    "backend_tech": ["nodejs", "express"],
    "hedera_network": "testnet"
})

final_state = workflow.invoke(initial_state)
```

### 3. Hedera Smart Contract Project

```python
# Request for smart contracts
user_request = """
Create Hedera smart contracts with:
- Token contract with custom functionality
- Multi-signature wallet
- Escrow contract
- Frontend for contract interaction
- Comprehensive testing suite
"""

initial_state = create_initial_state(user_request)
initial_state.update({
    "blockchain_tech": ["hedera", "solidity"],
    "frontend_tech": ["react", "typescript"],
    "backend_tech": ["nodejs", "hardhat"]
})

final_state = workflow.invoke(initial_state)
```

## Project Templates

The integration includes several pre-built templates:

### 1. Hedera AI Agent Template
- **Location**: Generated by `create_hedera_agent_template` tool
- **Features**:
  - TypeScript configuration
  - Hedera SDK integration
  - LangChain AI agent setup
  - Multiple AI provider support
  - CLI interface

### 2. Hedera DApp Template
- **Features**:
  - React frontend with TypeScript
  - Node.js backend with Express
  - Hedera wallet integration
  - Real-time updates
  - Modern UI components

### 3. Hedera Smart Contract Template
- **Features**:
  - Hardhat development environment
  - Solidity contracts
  - Testing framework
  - Deployment scripts
  - Frontend integration

## Dependencies

The Hedera integration requires these additional dependencies:

```json
{
  "hedera-agent-kit": "^1.0.0",
  "@hashgraph/sdk": "^2.7.0",
  "@langchain/openai": "^0.3.0",
  "@langchain/core": "^0.3.0",
  "langchain": "^0.3.0",
  "typescript": "^5.3.0",
  "@types/node": "^20.10.0"
}
```

## Environment Variables

Required environment variables for Hedera projects:

```env
# Hedera Configuration
HEDERA_ACCOUNT_ID="0.0.xxxxx"
HEDERA_PRIVATE_KEY="0x..."
HEDERA_NETWORK="testnet"

# AI Provider (choose one)
OPENAI_API_KEY="sk-proj-..."
ANTHROPIC_API_KEY="sk-ant-..."
GROQ_API_KEY="gsk_..."
OLLAMA_BASE_URL="http://localhost:11434"
```

## Workflow Integration

The Hedera agent is integrated into the NilCode workflow as follows:

1. **Planner** → Analyzes request and detects blockchain requirements
2. **Software Architect** → Creates project structure and documentation
3. **Coder** → Implements frontend/backend code
4. **Hedera Agent** → Implements blockchain functionality and AI integration
5. **Tester** → Validates all code and functionality
6. **Orchestrator** → Aggregates results and provides summary

## Security Considerations

- **Private Key Management**: Never commit private keys to version control
- **Environment Variables**: Use `.env` files for sensitive data
- **Network Selection**: Always test on testnet before mainnet
- **API Key Security**: Secure AI provider API keys
- **Transaction Validation**: Implement proper validation for all transactions

## Testing

The integration includes comprehensive testing:

```bash
# Run Hedera-specific tests
python examples/hedera_agent_example.py
python examples/hedera_dapp_example.py
python examples/hedera_smart_contract_example.py
```

## Troubleshooting

### Common Issues

1. **"No AI provider configured"**
   - Set one of the AI provider API keys in environment

2. **"HEDERA_ACCOUNT_ID is required"**
   - Set your Hedera account ID in the .env file

3. **"Rate limit exceeded"**
   - Wait and retry, or switch AI providers

4. **TypeScript compilation errors**
   - Check tsconfig.json configuration
   - Verify all dependencies are installed

### Getting Help

- [Hedera Documentation](https://docs.hedera.com/)
- [Hedera Agent Kit](https://github.com/hedera-dev/hedera-agent-kit)
- [LangChain Documentation](https://js.langchain.com/)
- [NilCode Documentation](README.md)

## Examples

See the `examples/` directory for complete working examples:

- `hedera_agent_example.py` - Basic AI agent
- `hedera_dapp_example.py` - Complete DApp
- `hedera_smart_contract_example.py` - Smart contract project

## Contributing

To contribute to the Hedera integration:

1. Follow the existing code patterns
2. Add comprehensive tests
3. Update documentation
4. Ensure security best practices
5. Test with multiple AI providers

## License

This integration follows the same license as the main NilCode project (MIT License).

